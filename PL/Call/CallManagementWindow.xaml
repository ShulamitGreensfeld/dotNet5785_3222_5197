<Window x:Class="PL.CallManagementWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:PL"
        Title="Call Management" Height="600" Width="800"
        DataContext="{Binding RelativeSource={RelativeSource Self}}"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <CollectionViewSource x:Key="CallTypeCollectionKey" Source="{Binding CallTypeCollection}" />
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter" />
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- ComboBox לסינון -->
        <ComboBox ItemsSource="{Binding Source={StaticResource CallTypeCollectionKey}}"
                  SelectedItem="{Binding SelectedCallType, Mode=TwoWay}"
                  SelectionChanged="ComboBox_SelectionChanged"
                  Margin="0,0,0,10"/>

        <!-- כפתור הוספת קריאה חדשה -->
        <Button Content="Add New Call" Grid.Row="0" HorizontalAlignment="Right" Click="AddCall_Click" Margin="0,0,0,10"/>

        <!-- ListView להצגת קריאות -->
        <ListView Grid.Row="1"
                  ItemsSource="{Binding CallList}"
                  SelectedItem="{Binding SelectedCall}">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="ID" DisplayMemberBinding="{Binding Id}" Width="100"/>
                    <GridViewColumn Header="Call ID" DisplayMemberBinding="{Binding CallId}" Width="100"/>
                    <GridViewColumn Header="Type" DisplayMemberBinding="{Binding CallType}" Width="150"/>
                    <GridViewColumn Header="Status" DisplayMemberBinding="{Binding CallStatus}" Width="150"/>
                    <GridViewColumn Header="Opening Time" DisplayMemberBinding="{Binding Opening_time}" Width="200"/>
                    <GridViewColumn Header="Time Left" DisplayMemberBinding="{Binding TimeLeft}" Width="150"/>
                    <GridViewColumn Header="Actions" Width="100">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="Delete"
                                        Click="DeleteCall_Click"
                                        Tag="{Binding}"
                                        IsEnabled="{Binding Path=CanBeDeleted}"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView>

    </Grid>
</Window>